<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="A clueless, curious programmer's ramblings">

    <title>Youtube Floater - BLOB</title>

    <link rel="canonical" href="http://ma08.github.io/Youtube-Floater/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">BLOB</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                
                <li>
                    <a href="/about/">About ma08</a>
                </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/shebang.jpg')">


    <script type="text/javascript" src="/js/mathjax.js"></script>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Youtube Floater</h1>
                    
                    <span class="meta"><!--Posted--> by ma08 on March 13, 2016</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<p>I am back to subject you with some more obscure stuff. As obscure as it can get.
This is more of documentation than communicating my thoughts with the rest of
the world. With the self deprecation out of the way, let&#39;s get to the point.</p>

<p>If you don&#39;t feel like reading the wall of text that follows, watch the video at the
end for a TLDR.</p>

<p>For a while I have been using mplayer2 as my default
player due to it&#39;s minimal interface. I got this brilliant idea of having a floating video window at the
top right corner such that I can work on something while viewing stuff to
minimize (or maximize I ain&#39;t sure) my efficiency. I use <a href="https://i3wm.org/">i3</a> as my window manager <a href="http://ma08.github.io/Tiling-Window-Managers/">which I talked about earlier here</a>.
Skip the i3 specific parts if you have no idea about it.
I&#39;ve defined a binding to float a window, set it to a specific size and place it in the top right corner.
Also making it a sticky window to make it stay there when moving across workspaces</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bindsym $mod+Shift+m floating enable; resize set 320 px 180 px; sticky enable; move window to position 1045 px 0 px</code></pre></figure>

<p>This is how it works.
<img src="/img/mplayer-floater.png" alt="Image alt" title="image title"></p>

<p>After getting used to this, I wanted something like this for youtube videos. 
Some way to extract out the player of youtube and manipulate it in such a way
that I can &quot;work&quot; away with a floating youtube player. I observed that whenever
youtube was in full screen it is placed in an X-window named &quot;plugin-container&quot;
or something. I tried using it to achieve the effect I was after but didn&#39;t have
much success with it. I gave up on this quest for a while.</p>

<p>Later while I found  <a href="https://www.reddit.com/r/unixporn/comments/49yjjg/oc_maybe_the_closest_thing_to_actual_unix_porn/d0vvp42">this</a>,
I went off on a tangent (trying to play videos in the form of ascii art) where I stumbled upon a solution to the youtube floater thingy I
wanted. I learned that you could play youtube videos with mplayer using <a href="https://rg3.github.io/youtube-dl/">youtube-dl</a>.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">youtube-dl -q -o- $url | mplayer -cache 8192  -</code></pre></figure>

<p>Once it starts playing I can make it a floater using my binding I talked about
earlier. This essentially solved my quest for the youtube floater. To use this, it requires having the url
of the youtube video which requires searching for something and getting the
video url. I wanted something more snippy. I combined the youtube floater with a
youtube &quot;I am feeling lucky&quot; thing. It essentially searches for something using
the search term and plays the first result of the search in mplayer. </p>

<p>It uses <a href="https://developers.google.com/youtube/v3/">Youtube Data API</a> by Google. Get an API Key to run it yourself.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python">#!/usr/bin/python

#install https://developers.google.com/api-client-library/python/ , youtube-dl and mplayer

from apiclient.discovery import build
from apiclient.errors import HttpError
from oauth2client.tools import argparser
import os
# Set DEVELOPER_KEY to the API key value from the APIs &amp; auth &gt; Registered apps
# tab of
#   https://cloud.google.com/console
# Please ensure that you have enabled the YouTube Data API for your project.
DEVELOPER_KEY = &quot;API KEY&quot;
YOUTUBE_API_SERVICE_NAME = &quot;youtube&quot;
YOUTUBE_API_VERSION = &quot;v3&quot;
def youtube_search(options):
  youtube = build(YOUTUBE_API_SERVICE_NAME, YOUTUBE_API_VERSION,
    developerKey=DEVELOPER_KEY)
  # Call the search.list method to retrieve results matching the specified
  # query term.
  search_response = youtube.search().list(
    q=options.q,
    type=&quot;video&quot;,
    safeSearch=&quot;none&quot;,
    #location=options.location,
    #locationRadius=options.location_radius,
    part=&quot;id,snippet&quot;,
    maxResults=options.max_results
  ).execute()
  urls=[]
  for search_result in search_response.get(&quot;items&quot;, []):
    urls.append(&quot;https://youtube.com/v/&quot;+search_result[&quot;id&quot;][&quot;videoId&quot;])
  os.system(&quot;youtube-dl -q -o- %s | mplayer -cache 4096  - &amp;&quot;%(urls[0]))
if __name__ == &quot;__main__&quot;:
  argparser.add_argument(&quot;--q&quot;, help=&quot;Search term&quot;, default=&quot;Google&quot;)
  #argparser.add_argument(&quot;--location&quot;, help=&quot;Location&quot;, default=&quot;37.42307,-122.08427&quot;)
  #argparser.add_argument(&quot;--location-radius&quot;, help=&quot;Location radius&quot;, default=&quot;5km&quot;)
  argparser.add_argument(&quot;--max-results&quot;, help=&quot;Max results&quot;, default=25)
  args = argparser.parse_args()
  try:
    youtube_search(args)
  except HttpError, e:
    print &quot;An HTTP error %d occurred:\n%s&quot; % (e.resp.status, e.content)</code></pre></figure>

<p>I wrote a bash script &quot;youtube-play.sh&quot; to call the python script.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">/path/to/youtube-play.py --q &quot;$1&quot; &gt; /dev/null 2&gt; /dev/null
#I know this is redundant. I could&#39;ve just used the python script as the only executable.</code></pre></figure>

<p>adding the folder of this script to the PATH variable in bashrc,</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">export PATH=$PATH:~/pro/executable_scripts</code></pre></figure>

<p>To run it</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">$ youtube-play.sh &quot;foo bar&quot;</code></pre></figure>

<p>I can run the whole jig from my <a href="https://davedavenport.github.io/rofi/">rofi</a> launcher.</p>

<p>TLDR: Playing youtube videos in a video player and some other stuff.
<iframe src="https://player.vimeo.com/video/158763290" width="500" height="281" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></p>

<p>Lots of stuff could&#39;ve have been done differently. I could have stored the
videos on disk such that multiple requests for the same video don&#39;t end up
taking unnecessary bandwidth. I could have created an interface using <a href="https://www.gnu.org/software/ncurses/">ncurses</a> to
navigate the results and select the required video (without using mouse - that&#39;s the point
of everything I do) instead of using the first result. </p>

<p>Maybe some other time if I find the motivation and the time aka never. </p>

<p>Fin.</p>

<p>P.S. If you are from KGP, don&#39;t use youtube if you can find the video on DC.</p>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/The-insanity-of-sanity/" data-toggle="tooltip" data-placement="top" title="The Insanity Of Sanity">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/YouPlay/" data-toggle="tooltip" data-placement="top" title="Youplay">Next Post &rarr;</a>
                    </li>
                    
                </ul>

<!-- Add Disqus comments. -->
<div id="disqus_thread"></div>
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'sourya4'; // required: replace example with your forum shortname
  var disqus_identifier = '_posts/2016-03-13-Youtube-Floater.md';
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http:/disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http:/disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>




            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://github.com/ma08">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://stackoverflow.com/users/3465519">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-stack-overflow fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; BLOB 2021</p>
            </div>
        </div>
    </div>
</footer>
<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-51744607-1']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
